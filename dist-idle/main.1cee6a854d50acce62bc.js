(()=>{"use strict";var e,t={766:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CameraAnimator=void 0;const i=o(904);class n extends i.Component{constructor(e,t){super(e,t),this.updateBeforeRender=()=>{},this.updateAfterRender=()=>{},this.totalFrames=30,this.animating=!1}animate(e=10,t){let o=this.object.getComponentByType(i.CameraController).getCamera();this.currentAnimation&&this.currentAnimation.stop(),this.currentAnimation=BABYLON.Animation.CreateAndStartAnimation("anim",o,"position",e,this.totalFrames,o.position,t,0,null,(()=>{this.animating=!1})),this.animating=!0}isAnimating(){return this.animating}setAnimating(e){this.animating=e}}t.CameraAnimator=n},967:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SkyboxAnimator=void 0;const i=o(904);class n extends i.Component{constructor(e,t){super(e,t),this.updateBeforeRender=()=>{this.object.getComponentByType(i.CubeSkyBoxComponent)&&this.object.getComponentByType(i.CubeSkyBoxComponent).get().rotate(this.rotationAxis,this.rotationSpeed,BABYLON.Space.LOCAL)},this.updateAfterRender=()=>{},this.rotationAxis=BABYLON.Axis.Y,this.rotationSpeed=.001}}t.SkyboxAnimator=n},881:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DroneComponent=void 0;const n=o(904),a=o(5);class s extends n.Component{constructor(e,t){super(e,t),this.interpolate=()=>{let e,t;this.lerpWeight+=this.animationSpeed,this.step<2?(e=this.target.getComponentByType(n.MeshComponent).position.clone(),e.y=this.startingPosition.y,t=this.startingPosition):(e=this.initiator.getComponentByType(n.MeshComponent).position.clone(),e.y=this.startingPosition.y,t=this.stopPosition);let o=BABYLON.Vector3.Lerp(t,e,this.lerpWeight);this.object.getComponentByType(n.MeshComponent).rotationQuaternion&&this.rotate&&(this.object.getComponentByType(n.MeshComponent).rotationQuaternion=BABYLON.Quaternion.RotationYawPitchRoll(this.initiator.getComponentByType(n.MeshComponent).rotationQuaternion.toEulerAngles().y,1.57,0)),this.object.getComponentByType(n.MeshComponent).get().position=o},this.onAttackDone=()=>{this.step=2},this.updateBeforeRender=()=>i(this,void 0,void 0,(function*(){this.target&&this.initiator&&(this.target.getComponentByType(n.MeshComponent)&&BABYLON.Vector3.Distance(this.target.getComponentByType(n.MeshComponent).position,this.object.getComponentByType(n.MeshComponent).position)<this.stopDistance&&this.step<2?0===this.step&&(this.lerpWeight=0,this.stopPosition=this.object.getComponentByType(n.MeshComponent).position.clone(),this.object.getComponentByType(a.DroneWeaponComponent).shootBullet(this.target),this.step=1):2===this.step&&this.lerpWeight>1?(this.object.dispose(),this.doneCallback&&this.doneCallback()):1!==this.step&&this.interpolate())})),e.getComponentByType(n.MeshComponent)&&(this.startingPosition=e.getComponentByType(n.MeshComponent).position.clone()),this.rotate=!1,this.lerpWeight=0,this.animationSpeed=.015,this.stopDistance=40,this.step=0}updateAfterRender(){}}t.DroneComponent=s},461:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectileComponent=void 0;const n=o(904),a=o(647);class s extends n.Component{constructor(e,t){super(e,t),this.interpolate=()=>{this.lerpWeight+=this.animationSpeed;let e=BABYLON.Vector3.Lerp(this.startingPosition,this.target.getComponentByType(n.MeshComponent).position,this.lerpWeight);this.object.getComponentByType(n.MeshComponent).rotationQuaternion&&this.rotate&&(this.object.getComponentByType(n.MeshComponent).rotationQuaternion=BABYLON.Quaternion.RotationYawPitchRoll(this.initiator.getComponentByType(n.MeshComponent).rotationQuaternion.toEulerAngles().y,1.57,0)),this.object.getComponentByType(n.MeshComponent).get().position=e},this.updateBeforeRender=()=>i(this,void 0,void 0,(function*(){if(this.target&&this.initiator){if(this.lerpWeight>=.9)return this.object.dispose(),yield this.target.getComponentByType(a.EngineComponent).onHit(),void(this.doneCallback&&(yield this.doneCallback()));this.interpolate()}})),e.getComponentByType(n.MeshComponent)&&(this.startingPosition=e.getComponentByType(n.MeshComponent).position.clone()),this.rotate=!1,this.lerpWeight=0,this.animationSpeed=.015}updateAfterRender(){}}t.ProjectileComponent=s},407:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExplosionParticle=void 0;const i=o(904),n=o(357);class a extends i.Component{constructor(e,t){super(e,t),this.particleEnd=()=>{this.fireBlast.dispose(!0),this.onAnimationEndCallback&&this.onAnimationEndCallback()},this.updateBeforeRender=()=>{},this.updateAfterRender=()=>{},this.scale=1,this.manualDependencies.push(i.MeshComponent)}explode(e){this.fireBlast=BABYLON.ParticleHelper.CreateDefault(this.object.getComponentByType(i.MeshComponent).get().position,100),this.fireBlast.createHemisphericEmitter(.2*this.scale,0),this.fireBlast.emitRate=100,this.fireBlast.minSize=6,this.fireBlast.maxSize=12,this.fireBlast.minEmitBox.scaleInPlace(this.scale),this.fireBlast.maxEmitBox.scaleInPlace(this.scale),this.fireBlast.minLifeTime=.5,this.fireBlast.maxLifeTime=1.5,this.fireBlast.minEmitPower=5,this.fireBlast.maxEmitPower=10,this.fireBlast.addLimitVelocityGradient(0,40),this.fireBlast.addLimitVelocityGradient(.12,12.983),this.fireBlast.addLimitVelocityGradient(.445,1.78),this.fireBlast.addLimitVelocityGradient(.691,.502),this.fireBlast.addLimitVelocityGradient(.93,.05),this.fireBlast.addLimitVelocityGradient(1,0),this.fireBlast.limitVelocityDamping=.9,console.log(this.object.getComponentByType(i.MeshComponent).get().getBoundingInfo().boundingBox),this.fireBlast.minInitialRotation=-Math.PI/2,this.fireBlast.maxInitialRotation=Math.PI/2,this.fireBlast.particleTexture=new BABYLON.Texture(n.Config.paths.textures+"particles/explosion.png",this.object.getWorld().getScene()),this.fireBlast.blendMode=BABYLON.ParticleSystem.BLENDMODE_MULTIPLYADD,this.fireBlast.addColorGradient(0,new BABYLON.Color4(1,1,1,0)),this.fireBlast.addColorGradient(.1,new BABYLON.Color4(1,1,1,1)),this.fireBlast.addColorGradient(.9,new BABYLON.Color4(1,1,1,1)),this.fireBlast.addColorGradient(1,new BABYLON.Color4(1,1,1,0)),this.fireBlast.addRampGradient(0,new BABYLON.Color3(1,1,1)),this.fireBlast.addRampGradient(.09,new BABYLON.Color3(209/255,.8,15/255)),this.fireBlast.addRampGradient(.18,new BABYLON.Color3(221/255,120/255,14/255)),this.fireBlast.addRampGradient(.28,new BABYLON.Color3(200/255,43/255,18/255)),this.fireBlast.addRampGradient(.47,new BABYLON.Color3(115/255,22/255,15/255)),this.fireBlast.addRampGradient(.88,new BABYLON.Color3(14/255,14/255,14/255)),this.fireBlast.addRampGradient(1,new BABYLON.Color3(14/255,14/255,14/255)),this.fireBlast.useRampGradients=!0,this.fireBlast.addColorRemapGradient(0,0,.1),this.fireBlast.addColorRemapGradient(.2,.1,.8),this.fireBlast.addColorRemapGradient(.3,.2,.85),this.fireBlast.addColorRemapGradient(.35,.4,.85),this.fireBlast.addColorRemapGradient(.4,.5,.9),this.fireBlast.addColorRemapGradient(.5,.95,1),this.fireBlast.addColorRemapGradient(1,.95,1),this.fireBlast.start(30),this.fireBlast.targetStopDuration=.4,this.fireBlast.onAnimationEnd=this.particleEnd,this.fireBlast.updateSpeed=1/30}unregister(){super.unregister()}}t.ExplosionParticle=a},5:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DroneWeaponComponent=void 0;const n=o(904),a=o(357),s=o(461),r=o(881),l=o(647),p=o(823);class h extends n.Component{constructor(e,t){super(e,t),this.updateBeforeRender=()=>{},this.updateAfterRender=()=>{}}createBullet(){return i(this,void 0,void 0,(function*(){const e=new n.GameObject("bullet",this.object.getWorld());(yield e.registerComponent(n.SetShapesComponent)).meshType=n.MeshType.SPHERE;let t=e.getComponentByType(n.MeshComponent);t.get().scaling=new BABYLON.Vector3(.002,.002,.002),t.get().position=this.object.getComponentByType(n.MeshComponent).position.clone();const o=yield e.registerComponent(n.ParticlesComponent);return o.particlesCapacity=200,o.particleTexture=new BABYLON.Texture(a.Config.paths.textures+"particles/smoke.jpg",this.object.getWorld().getScene()),yield e.registerComponent(s.ProjectileComponent),e}))}shootBullet(e){return i(this,void 0,void 0,(function*(){this.object.getComponentByType(p.RotationInterpolator).startRotation(this.object.getComponentByType(p.RotationInterpolator).getLookAtRotation(e.getComponentByType(n.MeshComponent).position));const t=(yield this.createBullet()).getComponentByType(s.ProjectileComponent);t.animationSpeed=a.Config.droneInfo.shootingAnimationSpeed,this.object.getComponentByType(l.EngineComponent)?t.doneCallback=this.object.getComponentByType(l.EngineComponent).onAttackDone:t.doneCallback=this.object.getComponentByType(r.DroneComponent).onAttackDone,t.target=e,t.initiator=this.object,t.rotate=!1,this.object.getWorld().getComponentByName("droneAudio").play()}))}}t.DroneWeaponComponent=h},647:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EngineComponent=void 0;const n=o(904),a=o(357),s=o(407),r=o(823);class l extends n.Component{constructor(e,t){super(e,t),this.onAttackDone=()=>i(this,void 0,void 0,(function*(){this.object.getComponentByType(r.RotationInterpolator)&&(this.object.getComponentByType(r.RotationInterpolator).startRotation(BABYLON.Quaternion.RotationAxis(BABYLON.Axis.Y,3.14)),this.isMySide&&this.object.getComponentByType(r.RotationInterpolator).startRotation(BABYLON.Quaternion.Zero()),this.onAttackEndCallback&&this.onAttackEndCallback())})),this.updateBeforeRender=()=>{if(this.healthBarObject&&this.healthBarObject.getComponentByType(n.MeshComponent)){let e=this.healthBarObject.getComponentByType(n.MeshComponent);e.position=this.object.getComponentByType(n.MeshComponent).position.clone(),e.position.y+=15}},this.updateAfterRender=()=>{},this.isMySide=!1}createHealthBar(){return i(this,void 0,void 0,(function*(){this.healthBarObject=new n.GameObject(this.shipId+"_healthBar",this.object.getWorld()),(yield this.healthBarObject.registerComponent(n.SetShapesComponent)).meshType=n.MeshType.PLANE;let e=this.healthBarObject.getComponentByType(n.MeshComponent);e.get().billboardMode=BABYLON.AbstractMesh.BILLBOARDMODE_ALL,e.get().scaling=new BABYLON.Vector3(a.Config.healthBarScale,.6,1),e.get().position=BABYLON.Vector3.Zero(),e.get().material=new BABYLON.StandardMaterial("billboard",this.object.getWorld().getScene()),e.get().material.backFaceCulling=!1,this.isMySide?(e.get().material.diffuseColor=BABYLON.Color3.Green(),e.get().material.emissiveColor=BABYLON.Color3.Green()):(e.get().material.diffuseColor=BABYLON.Color3.Red(),e.get().material.emissiveColor=BABYLON.Color3.Red()),e.get().material.disableLighting=!0,this.healthBarObject.removeComponentByType(n.SetShapesComponent)}))}calculateHealth(){return i(this,void 0,void 0,(function*(){this.health-=this.nextDamageHit,this.health<0&&(this.health=0);let e=this.health/this.maxHealth*100;this.healthBarObject.getComponentByType(n.MeshComponent).get().scaling.x=a.Config.healthBarScale*e/100,this.object.getWorld().getComponentByName("shipInfo"+this.shipId).get().getNodeById("currentHealth").text=this.health.toString(),this.object.getWorld().getComponentByName("missileAudio").isPlaying=!1;let t=this.object.getWorld().getComponentByName("explosionAudio");if(this.health<=0){t.volume=4,t.play();let e=this.object.getComponentByType(s.ExplosionParticle);e.scale=30,e.explode(null),this.healthBarObject.dispose(),this.healthBarObject=null,this.object.dispose()}}))}onHit(){return i(this,void 0,void 0,(function*(){let e=this.object.getWorld().getComponentByName("explosionAudio");this.object.getWorld().getComponentByName("missileAudio").isPlaying=!1;let t=this.object.getComponentByType(s.ExplosionParticle);e.volume=.5,e.play(),t.scale=15,t.explode(null)}))}}t.EngineComponent=l},823:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RotationInterpolator=void 0;const i=o(904);class n extends i.Component{constructor(e,t){super(e,t),this.updateBeforeRender=()=>{this.rotating&&this.rotate()},this.rotating=!1,this.manualDependencies.push(i.MeshComponent)}getLookAtRotation(e,t=!1){let o=t?3.14:0;return e=e.subtract(this.object.getComponentByType(i.MeshComponent).position),BABYLON.Quaternion.RotationYawPitchRoll(-Math.atan2(e.z,e.x)-Math.PI/2,o,0)}startRotation(e){this.rotationWeight=0,this.object.getComponentByType(i.MeshComponent).rotationQuaternion?this.oldRotationY=this.object.getComponentByType(i.MeshComponent).rotationQuaternion.toEulerAngles().y:this.oldRotationY=this.object.getComponentByType(i.MeshComponent).rotation.y,this.newRotationY=e.toEulerAngles().y,this.rotationLerpStep=.075,this.rotating=!0}rotate(){if(this.rotationWeight<1){this.rotationWeight+=Math.abs(this.rotationLerpStep),this.rotationWeight>1&&(this.rotationWeight=1,this.rotating=!1);const e=BABYLON.Quaternion.RotationYawPitchRoll(this.oldRotationY,0,0),t=BABYLON.Quaternion.RotationYawPitchRoll(this.newRotationY,0,0),o=BABYLON.Quaternion.Slerp(e,t,this.rotationWeight);this.object.getComponentByType(i.MeshComponent).rotationQuaternion=o}}updateAfterRender(){}}t.RotationInterpolator=n},568:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShipAnimator=void 0;const i=o(904);class n extends i.Component{constructor(e,t){super(e,t),this.updateBeforeRender=()=>{this.animating&&this.floatingRange>0&&(this.lerpWeight>=1&&(this.startingPosition=this.object.getComponentByType(i.MeshComponent).position.clone(),this.toAnimatePosition=this.generateRandomPosition(),this.lerpWeight=0),this.interpolate())},e.getComponentByType(i.MeshComponent)&&(this.startingPosition=e.getComponentByType(i.MeshComponent).position.clone(),this.defaultPosition=this.startingPosition.clone()),this.lerpWeight=0,this.floatingRange=0,this.floatingFrequency=0,this.animating=!1,this.toAnimatePosition=this.generateRandomPosition()}getRandomArbitrary(e,t){return Math.random()*(t-e)+e}generateRandomPosition(){let e=this.getRandomArbitrary(this.defaultPosition.x,this.defaultPosition.x+this.floatingRange),t=this.getRandomArbitrary(this.defaultPosition.y,this.defaultPosition.y+this.floatingRange),o=this.getRandomArbitrary(this.defaultPosition.z,this.defaultPosition.z+this.floatingRange);return new BABYLON.Vector3(e,t,o)}interpolate(){this.lerpWeight+=this.floatingFrequency/60;let e=BABYLON.Vector3.Lerp(this.startingPosition,this.toAnimatePosition,this.lerpWeight);this.object.getComponentByType(i.MeshComponent).get().position=e}updateAfterRender(){}}t.ShipAnimator=n},742:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ShipWeaponComponent=void 0;const n=o(904),a=o(357),s=o(461),r=o(881),l=o(647),p=o(823),h=o(890),c=o(5);class d extends n.Component{constructor(e,t){super(e,t),this.updateBeforeRender=()=>{},this.updateAfterRender=()=>{},this.missileStartPosition=BABYLON.Vector3.Zero(),this.laserStartPosition=BABYLON.Vector3.Zero(),this.dronesStartPosition=BABYLON.Vector3.Zero(),this.manualDependencies.push(n.MeshComponent),this.manualDependencies.push(l.EngineComponent),this.manualDependencies.push(p.RotationInterpolator)}createMissile(){return i(this,void 0,void 0,(function*(){const e=new n.GameObject("missile",this.object.getWorld()),t=yield e.registerComponent(n.MeshComponent);yield t.loadAsync(a.Config.paths.missiles,this.object.getComponentByType(l.EngineComponent).missileName),t.get().material.subMaterials[0].albedoTexture=new BABYLON.Texture(a.Config.paths.missiles+h.MissileName.MISSILE_TEXTURE,this.object.getWorld().getScene(),!1,!1),t.get().scaling=new BABYLON.Vector3(10,10,10),t.get().position=this.object.getComponentByType(n.MeshComponent).position.add(this.missileStartPosition.clone()),t.get().rotate(BABYLON.Axis.X,1.57,BABYLON.Space.LOCAL),this.object.getComponentByType(l.EngineComponent).isMySide&&t.get().rotate(BABYLON.Axis.Z,3.14,BABYLON.Space.LOCAL);const o=yield e.registerComponent(n.ParticlesComponent);return o.particlesCapacity=200,o.particleTexture=new BABYLON.Texture(a.Config.paths.textures+"particles/flame.jpg",this.object.getWorld().getScene()),o.minSize=3,o.maxSize=3,yield e.registerComponent(s.ProjectileComponent),e}))}createDrone(e){return i(this,void 0,void 0,(function*(){const t=new n.GameObject("drone",this.object.getWorld()),o=yield t.registerComponent(n.MeshComponent);o.loadMeshAsHidden=!0,yield o.loadAsync(a.Config.paths.missiles,h.MissileName.DRONE),o.get().isVisible=1,o.get().material.subMaterials[0].albedoTexture=new BABYLON.Texture(a.Config.paths.missiles+h.MissileName.MISSILE_TEXTURE,this.object.getWorld().getScene(),!1,!1),o.get().scaling=new BABYLON.Vector3(a.Config.droneInfo.scaling,a.Config.droneInfo.scaling,a.Config.droneInfo.scaling);let i=this.dronesStartPosition.clone();return i.x=e,o.get().position=this.object.getComponentByType(n.MeshComponent).position.add(i),yield t.registerComponent(r.DroneComponent),yield t.registerComponent(p.RotationInterpolator),yield t.registerComponent(c.DroneWeaponComponent),t}))}createLaser(){return i(this,void 0,void 0,(function*(){const e=new n.GameObject("laser",this.object.getWorld());(yield e.registerComponent(n.SetShapesComponent)).meshType=n.MeshType.CYLINDER;let t=e.getComponentByType(n.MeshComponent);return t.get().scaling=new BABYLON.Vector3(.25,a.Config.laserInfo.scaling,.25),t.get().position=this.laserStartPosition.clone(),t.get().position=this.object.getComponentByType(n.MeshComponent).position.add(this.laserStartPosition.clone()),t.get().material=new BABYLON.StandardMaterial("glow",this.object.getWorld().getScene()),t.get().material.emissiveColor=new BABYLON.Color3(0,.5,1),t.get().material.diffuseColor=new BABYLON.Color3(0,.5,1),t.get().rotate(BABYLON.Axis.X,1.57,BABYLON.Space.LOCAL),this.object.getWorld().getComponentByType(n.HighlightLayerComponent).add(t.get(),new BABYLON.Color3(0,.5,1)),yield e.registerComponent(s.ProjectileComponent),e}))}launchMissile(e){return i(this,void 0,void 0,(function*(){this.object.getComponentByType(p.RotationInterpolator).startRotation(this.object.getComponentByType(p.RotationInterpolator).getLookAtRotation(e.getComponentByType(n.MeshComponent).position,!0));const t=(yield this.createMissile()).getComponentByType(s.ProjectileComponent);t.animationSpeed=.02,t.doneCallback=()=>{this.object.getComponentByType(l.EngineComponent).onAttackDone(),e.getComponentByType(l.EngineComponent).calculateHealth()},t.target=e,t.initiator=this.object,t.rotate=!0,this.object.getWorld().getComponentByName("missileAudio").play()}))}performDroneAttack(e,t){return i(this,void 0,void 0,(function*(){let o=0;o=t/2*-1*a.Config.droneInfo.xSpacing;for(let i=0;i<t;i++)i===t-1?yield this.launchDrone(e,o,(()=>{this.object.getComponentByType(l.EngineComponent).onAttackDone(),e.getComponentByType(l.EngineComponent).calculateHealth()})):yield this.launchDrone(e,o),o+=a.Config.droneInfo.xSpacing}))}launchDrone(e,t,o=null){return i(this,void 0,void 0,(function*(){this.object.getComponentByType(p.RotationInterpolator).startRotation(this.object.getComponentByType(p.RotationInterpolator).getLookAtRotation(e.getComponentByType(n.MeshComponent).position,!0));const i=(yield this.createDrone(t)).getComponentByType(r.DroneComponent);i.animationSpeed=.01,i.target=e,i.initiator=this.object,i.doneCallback=o}))}performLaserAttack(e){return i(this,void 0,void 0,(function*(){this.shootLaser(e),setTimeout((()=>{this.shootLaser(e)}),200),setTimeout((()=>{this.shootLaser(e,(()=>{this.object.getComponentByType(l.EngineComponent).onAttackDone(),e.getComponentByType(l.EngineComponent).calculateHealth()}))}),400)}))}shootLaser(e,t=null){return i(this,void 0,void 0,(function*(){this.object.getComponentByType(p.RotationInterpolator).startRotation(this.object.getComponentByType(p.RotationInterpolator).getLookAtRotation(e.getComponentByType(n.MeshComponent).position,!0));const o=(yield this.createLaser()).getComponentByType(s.ProjectileComponent);o.animationSpeed=a.Config.laserInfo.animationSpeed,t&&(o.doneCallback=t),o.target=e,o.initiator=this.object,o.rotate=!0,this.object.getWorld().getComponentByName("laserAudio").play()}))}}t.ShipWeaponComponent=d},768:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TurnHandlingComponent=void 0;const n=o(904),a=o(357),s=o(398),r=o(930),l=o(766),p=o(647),h=o(742);class c extends n.Component{constructor(e,t){super(e,t),this.onShipAttackEnd=()=>{this.turnOnGoing=!1,this.object.getComponentByType(n.HighlightLayerComponent).removeAll();const e=this.object.getObjectByName(this.currentTurnMoves[this.currentMoveIndex-1].fromShipId),t=this.object.getObjectByName(this.currentTurnMoves[this.currentMoveIndex-1].toShipId);let o=e.getComponentByType(p.EngineComponent).shipId;this.object.getComponentByName("shipInfo"+o).get().getNodeById("shipInfo").thickness=1,this.object.getComponentByName("shipInfo"+o).get().getNodeById("shipInfo").background="#00111855",o=t.getComponentByType(p.EngineComponent).shipId,this.object.getComponentByName("shipInfo"+o).get().getNodeById("shipInfo").thickness=1,this.object.getComponentByName("shipInfo"+o).get().getNodeById("shipInfo").background="#00111855"},this.applyAttackTurn=()=>i(this,void 0,void 0,(function*(){const e=this.object.getObjectByName(this.currentTurnMoves[this.currentMoveIndex].fromShipId),t=this.object.getObjectByName(this.currentTurnMoves[this.currentMoveIndex].toShipId);if(!e||!t)return void(this.currentMoveIndex+=1);this.object.getComponentByType(n.HighlightLayerComponent).add(e.getComponentByType(n.MeshComponent).get(),BABYLON.Color3.White()),this.object.getComponentByType(n.HighlightLayerComponent).add(t.getComponentByType(n.MeshComponent).get(),BABYLON.Color3.Red()),this.turnOnGoing=!0,a.Config.staticCameraAnimation.active&&this.applyStaticAnimation(e);let o=e.getComponentByType(p.EngineComponent).shipId,i=t.getComponentByType(p.EngineComponent).shipId;switch(this.object.getComponentByName("shipInfo"+o).get().getNodeById("shipInfo").thickness=2,this.object.getComponentByName("shipInfo"+o).get().getNodeById("shipInfo").background="#77777755",this.object.getComponentByName("shipInfo"+i).get().getNodeById("shipInfo").thickness=2,this.object.getComponentByName("shipInfo"+i).get().getNodeById("shipInfo").background="#ff1c1c55",this.currentTurnMoves[this.currentMoveIndex].attackType){case s.AttackType.DRONE:yield e.getComponentByType(h.ShipWeaponComponent).performDroneAttack(t,this.currentTurnMoves[this.currentMoveIndex].count);break;case s.AttackType.LASER:yield e.getComponentByType(h.ShipWeaponComponent).performLaserAttack(t);break;case s.AttackType.MISSILE:yield e.getComponentByType(h.ShipWeaponComponent).launchMissile(t)}t.getComponentByType(p.EngineComponent).nextDamageHit=this.currentTurnMoves[this.currentMoveIndex].damageOnHP,e.getComponentByType(p.EngineComponent).onAttackEndCallback=this.onShipAttackEnd})),this.updateBeforeRender=()=>i(this,void 0,void 0,(function*(){if(this.started&&!this.turnOnGoing){if(this.currentTimer<this.maxWaitTimer)return void(this.currentTimer+=1);if(this.allTurnMoves.length>0&&0===this.currentMoveIndex)this.currentTurnMoves=this.allTurnMoves.shift();else if(0===this.allTurnMoves.length&&this.currentTurnMoves.length-1===this.currentMoveIndex)return this.started=!1,void(this.turnOnGoing=!1);if(this.currentMoveIndex>this.currentTurnMoves.length-1)return void(this.currentMoveIndex=0);switch(this.currentTurnMoves[this.currentMoveIndex].dataType){case r.DataType.ATTACK:yield this.applyAttackTurn(),this.maxWaitTimer=50;break;case r.DataType.CAMERA:this.object.getComponentByType(l.CameraAnimator).animate(a.Config.staticCameraAnimation.speed,new BABYLON.Vector3(this.currentTurnMoves[this.currentMoveIndex].x,this.currentTurnMoves[this.currentMoveIndex].y,this.currentTurnMoves[this.currentMoveIndex].z));break;case r.DataType.WAIT:this.maxWaitTimer=60*this.currentTurnMoves[this.currentMoveIndex].duration}this.currentMoveIndex+=1,this.currentTimer=0}})),this.allTurnMoves=[],this.currentTurnMoves=[],this.currentMoveIndex=0,this.started=!1,this.turnOnGoing=!1,this.currentTimer=0,this.maxWaitTimer=50}setTurnData(e){this.allTurnMoves.push(e),this.started=!0}applyStaticAnimation(e){let t=e.getComponentByType(n.MeshComponent).position.clone();t.y+=a.Config.staticCameraAnimation.yDistance,e.getComponentByType(p.EngineComponent).isMySide?t.z-=a.Config.staticCameraAnimation.zDistance:t.z+=a.Config.staticCameraAnimation.zDistance,this.object.getComponentByType(l.CameraAnimator).animate(a.Config.staticCameraAnimation.speed,t)}updateAfterRender(){}}t.TurnHandlingComponent=c},357:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Config=void 0,t.Config={paths:{models:"https://lightyear-game.vercel.app/assets/models/",missiles:"https://lightyear-game.vercel.app/assets/models/missles/",textures:"assets/textures/",guiLayouts:"assets/guiLayouts/",audio:{effects:"assets/sounds/effects/"}},healthBarScale:15,rangeOfFluctuationMultipler:10,attackDelayTime:100,lightIntensity:3,responsivity:{mobile:500,tablet:1400},droneInfo:{xSpacing:7,scaling:1,shootingAnimationSpeed:.08},laserInfo:{scaling:30,animationSpeed:.2},staticLayout:{active:!0,xSpacing:20,zSpacing:10,initialZ:70},staticCameraAnimation:{active:!0,zDistance:100,yDistance:50,speed:5}}},890:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.MissileName=void 0,(o=t.MissileName||(t.MissileName={})).MISSILE01="SM_Prop_Missile_01.glb",o.MISSILE03="SM_Prop_Missile_03.glb",o.MISSILE04="SM_Prop_Missile_04.glb",o.MISSILE07="SM_Prop_Missile_07.glb",o.DRONE="SM_Veh_Drone_01.glb",o.MISSILE_TEXTURE="PolygonSciFiSpace_Texture_01_A.png"},258:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.SpaceShipName=void 0,(o=t.SpaceShipName||(t.SpaceShipName={})).ASTEROID_MINER="asteroid-miner",o.BATTLE_CRUISER="battle_cruiser",o.BATTLESHIP="battleship",o.COLONY_SHIP="colony_ship",o.CRAWLER="crawler",o.CRUISER="cruiser",o.DEMOLISHER="demolisher",o.DESTROYER="destroyer",o.FALCON="falcon",o.GALLEON="galleon",o.HEAVY_CARGO="heavy-cargo",o.HEAVY_CRAFT="heavy-craft",o.HEAVY_FIGHTER="heavy-fighter",o.LIGHT_CARGO="light-cargo",o.LIGHT_CRAFT="light-craft",o.LIGHT_FIGHTER="light-fighter",o.PLANET_BOMBER="planet-bomber",o.REAPER="reaper",o.RECYCLER="recycler",o.SPACE_STATION="space-station"},710:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(890),n=o(258),a=new Map([[n.SpaceShipName.ASTEROID_MINER,{name:n.SpaceShipName.ASTEROID_MINER,path:"asteroid-miner/",fileName:"Asteroid_Miner.glb",textureName:"Asteroid_Miner_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(-.015,.02,-.04),jetFirePosition2:new BABYLON.Vector3(.015,.02,-.04),jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.BATTLE_CRUISER,{name:n.SpaceShipName.BATTLE_CRUISER,path:"battle-cruiser/",fileName:"Battle_Cruiser.glb",textureName:"Battle_Cruiser_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.BATTLESHIP,{name:n.SpaceShipName.BATTLESHIP,path:"battleship/",fileName:"Battleship.glb",textureName:"Battleship_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,.02,-.09),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.COLONY_SHIP,{name:n.SpaceShipName.COLONY_SHIP,path:"colony-ship/",fileName:"Colony_Ship.glb",textureName:"Colony_Ship_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.CRAWLER,{name:n.SpaceShipName.CRAWLER,path:"crawler/",fileName:"Crawler.glb",textureName:"Crawler_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.01),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.DEMOLISHER,{name:n.SpaceShipName.DEMOLISHER,path:"demolisher/",fileName:"Demolisher.glb",textureName:"Demolisher_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,.035,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE03,scale:200}],[n.SpaceShipName.DESTROYER,{name:n.SpaceShipName.DESTROYER,path:"destroyer/",fileName:"Destroyer.glb",textureName:"Destroyer_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE07,scale:200}],[n.SpaceShipName.FALCON,{name:n.SpaceShipName.FALCON,path:"falcon/",fileName:"Falcon.glb",textureName:"Falcon_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.GALLEON,{name:n.SpaceShipName.GALLEON,path:"galleon/",fileName:"Galleon.glb",textureName:"Galleon_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.HEAVY_CARGO,{name:n.SpaceShipName.HEAVY_CARGO,path:"heavy-cargo/",fileName:"Heavy_Cargo.glb",textureName:"Heavy_Cargo_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.HEAVY_CRAFT,{name:n.SpaceShipName.HEAVY_CRAFT,path:"heavy-craft/",fileName:"Heavy_Craft.glb",textureName:"Heavy_Craft_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.HEAVY_FIGHTER,{name:n.SpaceShipName.HEAVY_FIGHTER,path:"heavy-fighter/",fileName:"Heavy_Fighter.glb",textureName:"Heavy_Fighter_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,.005,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE07,scale:200}],[n.SpaceShipName.LIGHT_CARGO,{name:n.SpaceShipName.LIGHT_CARGO,path:"light-cargo/",fileName:"Light_Cargo.glb",textureName:"Light_Cargo_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.LIGHT_CRAFT,{name:n.SpaceShipName.LIGHT_CRAFT,path:"light-craft/",fileName:"Light_Craft.glb",textureName:"Light_Craft_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.LIGHT_FIGHTER,{name:n.SpaceShipName.LIGHT_FIGHTER,path:"light-fighter/",fileName:"Light_Fighter.glb",textureName:"Light_Fighter_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.PLANET_BOMBER,{name:n.SpaceShipName.PLANET_BOMBER,path:"planet-bomber/",fileName:"Planet_Bomber.glb",textureName:"Planet_Bomber_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(-.015,.01,-.05),jetFirePosition2:new BABYLON.Vector3(.015,.01,-.05),jetFirePosition3:null,missileName:i.MissileName.MISSILE03,scale:200}],[n.SpaceShipName.REAPER,{name:n.SpaceShipName.REAPER,path:"reaper/",fileName:"Reaper.glb",textureName:"Reaper_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE04,scale:200}],[n.SpaceShipName.RECYCLER,{name:n.SpaceShipName.RECYCLER,path:"recycler/",fileName:"Recycler.glb",textureName:"Recycler_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}],[n.SpaceShipName.SPACE_STATION,{name:n.SpaceShipName.SPACE_STATION,path:"space-station/",fileName:"Space_Station.glb",textureName:"Space_Station_BaseColor.jpg",laserPosition:BABYLON.Vector3.Zero(),missilePosition:BABYLON.Vector3.Zero(),dronesPosition:new BABYLON.Vector3(0,20,0),jetFirePosition:new BABYLON.Vector3(0,0,-.04),jetFirePosition2:null,jetFirePosition3:null,missileName:i.MissileName.MISSILE01,scale:200}]]);t.default=a},142:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Main=void 0;const n=o(904),a=o(568),s=o(357),r=o(710),l=o(647),p=o(967),h=o(407),c=o(742),d=o(768),m=o(823),u=o(766);t.Main=class{constructor(e){this.setCallbacks=(e,t)=>{},this.onSwitchAudio=()=>{BABYLON.Engine.audioEngine.unlocked&&BABYLON.Engine.audioEngine.getGlobalVolume()>0?(BABYLON.Engine.audioEngine.setGlobalVolume(0),this.world.getComponentByName("worldLayout").get().getNodeById("audioImage").source="assets/images/speaker_off.png",this.world.getComponentByName("worldLayout").get().getNodeById("audioContainer").color="red"):(BABYLON.Engine.audioEngine.unlock(),BABYLON.Engine.audioEngine.setGlobalVolume(1),this.world.getComponentByName("worldLayout").get().getNodeById("audioImage").source="assets/images/speaker.png",this.world.getComponentByName("worldLayout").get().getNodeById("audioContainer").color="#4B6975")},this.setEnvironmentData=e=>i(this,void 0,void 0,(function*(){if(s.Config.staticLayout.active)yield this.loadStaticLayout(e);else for(let t of e)yield this.addSpaceship(t),yield this.addShipInfoGUI(t);this.onReady()})),this.setAttackTurn=e=>i(this,void 0,void 0,(function*(){this.world.getComponentByType(d.TurnHandlingComponent).setTurnData(e)})),this.view=e,this.started=!1}getWorld(){return this.world}isStarted(){return this.started}setup(e){return i(this,void 0,void 0,(function*(){yield this.setWorld(null),this.onReady=e,this.world.start(),this.started=!0}))}setWorld(e){return i(this,void 0,void 0,(function*(){this.view.blur();const t=Math.max(document.documentElement.clientWidth,window.innerWidth||0);this.world=new n.World(this.view,n.EngineType.STANDARD,e),yield this.world.init(!0,!0);const o=yield this.world.registerComponent(n.ArcRotateCameraController);o.position=new BABYLON.Vector3(0,150,0),o.getCamera().lockedTarget=BABYLON.Vector3.Zero(),o.getCamera().beta=.8,o.getCamera().alpha=6,t<s.Config.responsivity.mobile&&(o.getCamera().lowerRadiusLimit=300),(yield this.world.registerComponent(n.HemisphericLightComponent)).intensity=s.Config.lightIntensity,(yield this.world.registerComponent(n.CubeSkyBoxComponent)).texturePath=s.Config.paths.textures+"skybox1/skybox1";let i=yield this.world.registerComponent(n.GUIContainerComponent);t<s.Config.responsivity.tablet&&(i.get().renderScale=.6),t<s.Config.responsivity.mobile&&(i.get().renderScale=.55),yield this.world.registerComponent(p.SkyboxAnimator),(yield this.world.registerComponent(d.TurnHandlingComponent)).maxWaitTimer=s.Config.attackDelayTime,yield this.world.registerComponent(u.CameraAnimator);let a=yield this.world.registerComponent(n.XmlGUIComponent);yield a.loadAsync(s.Config.paths.guiLayouts,"worldLayout.xml"),a.name="worldLayout",a.get().getNodeById("audioContainer").onPointerClickObservable.add(this.onSwitchAudio);let r=yield this.world.registerComponent(n.XmlGUIComponent);yield r.loadAsync(s.Config.paths.guiLayouts,"endGame.xml"),r.name="endGameModal",BABYLON.Engine.audioEngine.useCustomUnlockedButton=!0,yield this.world.registerComponent(n.HighlightLayerComponent),this.setupAudio()}))}setupAudio(){return i(this,void 0,void 0,(function*(){let e=yield this.world.registerComponent(n.SoundComponent);yield e.loadAsync(s.Config.paths.audio.effects,"laser.mp3"),e.name="laserAudio",e=yield this.world.registerComponent(n.SoundComponent),yield e.loadAsync(s.Config.paths.audio.effects,"explosion.wav"),e.name="explosionAudio",e=yield this.world.registerComponent(n.SoundComponent),yield e.loadAsync(s.Config.paths.audio.effects,"missile.mp3"),e.name="missileAudio",e=yield this.world.registerComponent(n.SoundComponent),yield e.loadAsync(s.Config.paths.audio.effects,"droneAttack.mp3"),e.name="droneAudio",BABYLON.Engine.audioEngine.lock()}))}addSpaceship(e,t=null){return i(this,void 0,void 0,(function*(){const o=new n.GameObject(e.shipId,this.world),i=yield o.registerComponent(n.MeshComponent);yield i.loadAsync(s.Config.paths.models+r.default.get(e.shipType).path,r.default.get(e.shipType).fileName),i.get().material.subMaterials[0].albedoTexture=new BABYLON.Texture(s.Config.paths.models+r.default.get(e.shipType).path+r.default.get(e.shipType).textureName,this.world.getScene(),!1,!1),s.Config.staticLayout.active?t&&(i.position=t.clone()):i.position=new BABYLON.Vector3(e.x,e.y,e.z),i.get().scaling=new BABYLON.Vector3(r.default.get(e.shipType).scale,r.default.get(e.shipType).scale,r.default.get(e.shipType).scale),i.get().material.depthFunction=BABYLON.Engine.ALWAYS;const p=yield o.registerComponent(a.ShipAnimator);p.floatingFrequency=e.frequencyOfFluctuaction,p.floatingRange=e.radiusOfFluctuation*s.Config.rangeOfFluctuationMultipler,p.animating=!0;const d=yield o.registerComponent(l.EngineComponent);d.health=e.initialHP,d.maxHealth=e.initialHP,d.isMySide=e.isMySide,d.missileName=r.default.get(e.shipType).missileName,d.shipId=e.shipId,yield d.createHealthBar(),yield o.registerComponent(m.RotationInterpolator);const u=yield o.registerComponent(c.ShipWeaponComponent);u.missileStartPosition=r.default.get(e.shipType).missilePosition,u.laserStartPosition=r.default.get(e.shipType).laserPosition,u.dronesStartPosition=r.default.get(e.shipType).dronesPosition,yield o.registerComponent(h.ExplosionParticle),yield this.addShipJetFire(o,r.default.get(e.shipType).jetFirePosition),r.default.get(e.shipType).jetFirePosition2&&(yield this.addShipJetFire(o,r.default.get(e.shipType).jetFirePosition2)),r.default.get(e.shipType).jetFirePosition3&&(yield this.addShipJetFire(o,r.default.get(e.shipType).jetFirePosition3)),e.isMySide||i.rotate(BABYLON.Axis.Y,3.14,BABYLON.Space.LOCAL)}))}addShipJetFire(e,t){return i(this,void 0,void 0,(function*(){const o=yield e.registerComponent(n.ParticlesComponent);o.particlesCapacity=50,o.particleTexture=new BABYLON.Texture(s.Config.paths.textures+"particles/blue_flame.jpg",this.getWorld().getScene()),o.minSize=.01,o.maxSize=3,o.minEmitPower=.01,o.maxEmitPower=.05,o.direction1=new BABYLON.Vector3(0,-.2,-1.5),o.direction2=new BABYLON.Vector3(0,-.2,-1.5),o.minEmitBox=t,o.maxEmitBox=t}))}addShipInfoGUI(e){return i(this,void 0,void 0,(function*(){let t="myShipInfo.xml",o="leftShipContainer";e.isMySide||(t="otherShipInfo.xml",o="rightShipContainer");let i=yield this.world.registerComponent(n.XmlGUIComponent);i.attached="false",yield i.loadAsync(s.Config.paths.guiLayouts,t),i.name="shipInfo"+e.shipId,i.get().getNodeById("shipName").text=e.shipId,i.get().getNodeById("currentHealth").text=e.initialHP,i.get().getNodeById("maxHealth").text=e.initialHP,this.world.getComponentByName("worldLayout").get().getNodeById(o).addControl(i.get().getNodeById("shipInfo"))}))}loadStaticLayout(e){return i(this,void 0,void 0,(function*(){const t=[],o=[];for(let i of e)i.isMySide?o.push(i):t.push(i),yield this.addShipInfoGUI(i);let i=0,n=s.Config.staticLayout.initialZ;i=t.length/2*-1*s.Config.staticLayout.xSpacing;for(let e=0;e<t.length;e++)e<=t.length/2?n-=s.Config.staticLayout.zSpacing:n+=s.Config.staticLayout.zSpacing,yield this.addSpaceship(t[e],new BABYLON.Vector3(i,0,n)),i+=s.Config.staticLayout.xSpacing;n=-1*s.Config.staticLayout.initialZ,i=o.length/2*-1*s.Config.staticLayout.xSpacing;for(let e=0;e<o.length;e++)e<=o.length/2?n+=s.Config.staticLayout.zSpacing:n-=s.Config.staticLayout.zSpacing,yield this.addSpaceship(o[e],new BABYLON.Vector3(i,0,n)),i+=s.Config.staticLayout.xSpacing}))}}},386:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(398),n=o(930),a=[{dataType:n.DataType.ATTACK,attackType:i.AttackType.LASER,fromShipId:"1",toShipId:"6",damageOnHP:1020,count:2},{dataType:n.DataType.WAIT,duration:2},{dataType:n.DataType.ATTACK,attackType:i.AttackType.DRONE,count:2,fromShipId:"2",toShipId:"5",damageOnHP:12},{dataType:n.DataType.ATTACK,attackType:i.AttackType.LASER,fromShipId:"3",toShipId:"7",damageOnHP:7,count:3},{dataType:n.DataType.ATTACK,attackType:i.AttackType.MISSILE,fromShipId:"4",toShipId:"8",damageOnHP:10,count:3},{dataType:n.DataType.ATTACK,attackType:i.AttackType.DRONE,fromShipId:"5",toShipId:"2",count:3,damageOnHP:10},{dataType:n.DataType.ATTACK,attackType:i.AttackType.LASER,fromShipId:"6",toShipId:"3",count:3,damageOnHP:12},{dataType:n.DataType.ATTACK,attackType:i.AttackType.MISSILE,fromShipId:"7",toShipId:"1",count:3,damageOnHP:70},{dataType:n.DataType.ATTACK,attackType:i.AttackType.MISSILE,fromShipId:"8",toShipId:"4",count:3,damageOnHP:18}];t.default=a},161:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=o(258),n=[{shipId:"1",shipType:i.SpaceShipName.ASTEROID_MINER,x:0,y:0,z:-50,isMySide:!0,initialHP:100,frequencyOfFluctuaction:2,radiusOfFluctuation:.5},{shipId:"2",shipType:i.SpaceShipName.BATTLESHIP,x:30,y:0,z:-50,isMySide:!0,initialHP:100,frequencyOfFluctuaction:1,radiusOfFluctuation:.7},{shipId:"3",shipType:i.SpaceShipName.CRAWLER,x:-30,y:0,z:-50,isMySide:!0,initialHP:100,frequencyOfFluctuaction:1,radiusOfFluctuation:.2},{shipId:"4",shipType:i.SpaceShipName.HEAVY_FIGHTER,x:-60,y:0,z:-50,isMySide:!0,initialHP:120,frequencyOfFluctuaction:1,radiusOfFluctuation:.3},{shipId:"5",shipType:i.SpaceShipName.DEMOLISHER,x:0,y:0,z:50,isMySide:!1,initialHP:100,frequencyOfFluctuaction:1,radiusOfFluctuation:.2},{shipId:"6",shipType:i.SpaceShipName.DESTROYER,x:30,y:0,z:50,isMySide:!1,initialHP:100,frequencyOfFluctuaction:1,radiusOfFluctuation:.4},{shipId:"7",shipType:i.SpaceShipName.PLANET_BOMBER,x:-30,y:0,z:50,isMySide:!1,initialHP:100,frequencyOfFluctuaction:1,radiusOfFluctuation:.5},{shipId:"8",shipType:i.SpaceShipName.RECYCLER,x:-60,y:0,z:50,isMySide:!1,initialHP:120,frequencyOfFluctuaction:1,radiusOfFluctuation:.6}];t.default=n},398:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.AttackType=void 0,(o=t.AttackType||(t.AttackType={})).DRONE="drone",o.LASER="laser",o.MISSILE="missile"},930:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.DataType=void 0,(o=t.DataType||(t.DataType={}))[o.CAMERA=0]="CAMERA",o[o.WAIT=1]="WAIT",o[o.ATTACK=2]="ATTACK"},607:function(e,t,o){var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=o(142),a=o(386),s=o(161),r=document.getElementById("view");let l=new n.Main(r);function p(){console.log("is ready"),document.getElementById("loader").style.display="none",document.getElementById("view").style.display="block",l.getWorld().getEngine().resize(),l.setAttackTurn(a.default)}window.onAttack=function(e){l.setAttackTurn(e)},window.onmessage=function(e){console.log(e)},function(){i(this,void 0,void 0,(function*(){yield l.setup(p),yield l.setEnvironmentData(s.default)}))}()}},o={};function i(e){var n=o[e];if(void 0!==n)return n.exports;var a=o[e]={exports:{}};return t[e].call(a.exports,a,a.exports,i),a.exports}i.m=t,e=[],i.O=(t,o,n,a)=>{if(!o){var s=1/0;for(h=0;h<e.length;h++){for(var[o,n,a]=e[h],r=!0,l=0;l<o.length;l++)(!1&a||s>=a)&&Object.keys(i.O).every((e=>i.O[e](o[l])))?o.splice(l--,1):(r=!1,a<s&&(s=a));if(r){e.splice(h--,1);var p=n();void 0!==p&&(t=p)}}return t}a=a||0;for(var h=e.length;h>0&&e[h-1][2]>a;h--)e[h]=e[h-1];e[h]=[o,n,a]},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};i.O.j=t=>0===e[t];var t=(t,o)=>{var n,a,[s,r,l]=o,p=0;if(s.some((t=>0!==e[t]))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(l)var h=l(i)}for(t&&t(o);p<s.length;p++)a=s[p],i.o(e,a)&&e[a]&&e[a][0](),e[s[p]]=0;return i.O(h)},o=self.webpackChunklightyear_battle_scene=self.webpackChunklightyear_battle_scene||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var n=i.O(void 0,[904],(()=>i(607)));n=i.O(n)})();